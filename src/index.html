<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arsychat Ai - Multi-Model Comparison</title>
    <!-- External Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0c0c0e; color: #e4e4e7; }
        .glass { background: rgba(24, 24, 27, 0.7); backdrop-filter: blur(14px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .custom-scrollbar::-webkit-scrollbar { width: 5px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #27272a; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #3f3f46; }
        
        /* Markdown Styling */
        .markdown-body pre { background: #000; padding: 1rem; border-radius: 0.75rem; margin: 1rem 0; overflow-x: auto; border: 1px solid #27272a; font-family: 'Courier New', monospace; font-size: 0.85rem; }
        .markdown-body code { color: #60a5fa; background: rgba(59, 130, 246, 0.1); padding: 0.1rem 0.3rem; border-radius: 4px; }
        .markdown-body p { margin-bottom: 0.8rem; line-height: 1.7; }
        .markdown-body ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem; }
        
        /* Animations */
        @keyframes shine { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
        .loading-pulse { animation: shine 2s infinite ease-in-out; }
        .panel-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .panel-card:hover { border-color: rgba(59, 130, 246, 0.3); transform: translateY(-2px); }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- Header Section -->
    <header class="h-16 flex items-center justify-between px-6 border-b border-white/5 glass z-50">
        <div class="flex items-center gap-3">
            <div class="w-9 h-9 bg-gradient-to-br from-blue-600 to-blue-800 rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/20">
                <span class="text-white font-bold text-xl italic">A</span>
            </div>
            <div>
                <h1 class="text-lg font-bold tracking-tight text-white leading-none">Arsychat <span class="text-blue-500 font-extrabold">Ai</span></h1>
                <span class="text-[9px] text-zinc-500 font-bold uppercase tracking-[0.2em]">Parallel POST Engine</span>
            </div>
        </div>
        <div class="flex items-center gap-4">
            <div class="hidden md:flex flex-col items-end">
                <span class="text-[10px] font-bold text-emerald-500 flex items-center gap-1.5 uppercase">
                    <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"></span> Systems Operational
                </span>
                <span class="text-[9px] text-zinc-500 font-medium">Hugging Face Router v1.2</span>
            </div>
        </div>
    </header>

    <!-- Comparison Grid -->
    <main class="flex-1 overflow-y-auto md:overflow-hidden p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="view-grid">
        
        <!-- GLM-4 Card -->
        <section class="panel-card glass rounded-2xl flex flex-col overflow-hidden border-zinc-800">
            <div class="p-3 border-b border-white/5 bg-white/[0.02] flex justify-between items-center">
                <h2 class="text-[10px] font-black uppercase tracking-widest text-blue-400">GLM-4.6 (Flash)</h2>
                <div id="loader-glm" class="hidden"><div class="w-3 h-3 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>
            </div>
            <div id="out-glm" class="flex-1 overflow-y-auto p-4 custom-scrollbar markdown-body text-sm text-zinc-500 italic">
                Awaiting your prompt...
            </div>
        </section>

        <!-- KIMI Card -->
        <section class="panel-card glass rounded-2xl flex flex-col overflow-hidden border-zinc-800">
            <div class="p-3 border-b border-white/5 bg-white/[0.02] flex justify-between items-center">
                <h2 class="text-[10px] font-black uppercase tracking-widest text-emerald-400">KIMI-K2 (Thinking)</h2>
                <div id="loader-kimi" class="hidden"><div class="w-3 h-3 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"></div></div>
            </div>
            <div id="out-kimi" class="flex-1 overflow-y-auto p-4 custom-scrollbar markdown-body text-sm text-zinc-500 italic">
                Side-by-side comparison ready.
            </div>
        </section>

        <!-- DeepSeek Card -->
        <section class="panel-card glass rounded-2xl flex flex-col overflow-hidden border-zinc-800">
            <div class="p-3 border-b border-white/5 bg-white/[0.02] flex justify-between items-center">
                <h2 class="text-[10px] font-black uppercase tracking-widest text-cyan-400">DeepSeek-V3</h2>
                <div id="loader-deepseek" class="hidden"><div class="w-3 h-3 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"></div></div>
            </div>
            <div id="out-deepseek" class="flex-1 overflow-y-auto p-4 custom-scrollbar markdown-body text-sm text-zinc-500 italic">
                Analysis standby...
            </div>
        </section>

        <!-- Qwen Card -->
        <section class="panel-card glass rounded-2xl flex flex-col overflow-hidden border-zinc-800">
            <div class="p-3 border-b border-white/5 bg-white/[0.02] flex justify-between items-center">
                <h2 class="text-[10px] font-black uppercase tracking-widest text-purple-400">Qwen-2.5 (VL)</h2>
                <div id="loader-qwen" class="hidden"><div class="w-3 h-3 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"></div></div>
            </div>
            <div id="out-qwen" class="flex-1 overflow-y-auto p-4 custom-scrollbar markdown-body text-sm text-zinc-500 italic">
                Parallel inference active.
            </div>
        </section>

    </main>

    <!-- Input Section -->
    <footer class="p-6 bg-gradient-to-t from-black to-transparent z-50">
        <div class="max-w-4xl mx-auto relative group">
            <form id="chat-form">
                <textarea 
                    id="user-prompt"
                    rows="1"
                    placeholder="Ask across all models... (Shift+Enter for new line)"
                    class="w-full bg-zinc-900 border border-zinc-800 rounded-2xl py-4 pl-6 pr-16 focus:outline-none focus:ring-2 focus:ring-blue-600/40 focus:border-blue-600/40 transition-all resize-none shadow-2xl custom-scrollbar"
                ></textarea>
                <button 
                    type="submit"
                    id="submit-btn"
                    class="absolute right-3 bottom-3 p-3 bg-blue-600 hover:bg-blue-500 text-white rounded-xl transition-all shadow-lg disabled:opacity-30 disabled:grayscale"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                    </svg>
                </button>
            </form>
            <p class="text-center text-[9px] text-zinc-600 mt-4 font-bold uppercase tracking-[0.3em]">
                â€¢ Multi-Node Inference
            </p>
        </div>
    </footer>

    <script>
        /**
         * Production Configuration
         */
        const CONFIG = {
            baseUrl: "https://arsychat-api.metaspace.workers.dev/api",
            models: ["glm", "kimi", "deepseek", "qwen"]
        };

        const form = document.getElementById('chat-form');
        const promptInput = document.getElementById('user-prompt');
        const submitBtn = document.getElementById('submit-btn');

        // Textarea Auto-Resize
        promptInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
            if(this.scrollHeight > 150) this.style.overflowY = 'auto';
        });

        /**
         * Parallel API Execution (POST Method)
         */
        async function fetchModelResponse(model) {
            const prompt = promptInput.value.trim();
            const outputEl = document.getElementById(`out-${model}`);
            const loader = document.getElementById(`loader-${model}`);
            
            // UI Set Loading
            loader.classList.remove('hidden');
            outputEl.innerHTML = `<div class="space-y-3 loading-pulse">
                <div class="h-2 bg-white/5 rounded w-3/4"></div>
                <div class="h-2 bg-white/5 rounded w-full"></div>
                <div class="h-2 bg-white/5 rounded w-5/6"></div>
            </div>`;

            try {
                // Using POST for reliability with large prompts
                const response = await fetch(`${CONFIG.baseUrl}/${model}/v1/chat/completions`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        prompt: prompt,
                        max_tokens: 2048
                    })
                });

                if (!response.ok) throw new Error(`HTTP Error: ${response.status}`);

                const data = await response.json();
                
                // Content Extraction (Compatible with OpenAI format)
                let finalContent = "";
                if (data.choices && data.choices[0]?.message) {
                    finalContent = data.choices[0].message.content;
                } else if (data.response) {
                    finalContent = data.response;
                } else {
                    finalContent = "Received malformed JSON response from model.";
                }

                outputEl.classList.remove('italic', 'text-zinc-500');
                outputEl.innerHTML = marked.parse(finalContent);

            } catch (err) {
                outputEl.innerHTML = `<div class="p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400 text-xs font-mono">
                    <b>FETCH ERROR:</b><br>${err.message}<br><br>
                    <span class="opacity-70 italic text-[10px]">Verify Worker endpoint and CORS configuration.</span>
                </div>`;
            } finally {
                loader.classList.add('hidden');
                checkGlobalState();
            }
        }

        let completedRequests = 0;
        function checkGlobalState() {
            completedRequests++;
            if (completedRequests === CONFIG.models.length) {
                submitBtn.disabled = false;
            }
        }

        /**
         * Event Listeners
         */
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const promptValue = promptInput.value.trim();
            if (!promptValue) return;

            // Reset States
            completedRequests = 0;
            submitBtn.disabled = true;

            // Trigger Parallel Calls
            CONFIG.models.forEach(m => fetchModelResponse(m));
            
            // Clear Input
            promptInput.value = '';
            promptInput.style.height = 'auto';
        });

        // Handle Enter key for submit (exclude mobile or Shift+Enter)
        promptInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey && window.innerWidth > 768) {
                e.preventDefault();
                form.dispatchEvent(new Event('submit'));
            }
        });

        // Configure Marked.js
        marked.setOptions({
            breaks: true,
            gfm: true,
            headerIds: false,
            mangle: false
        }); it
    </script>
</body>
</html>
